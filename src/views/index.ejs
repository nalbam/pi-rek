<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>rpi-rek</title>
    <script src="http://cdn.binaryjs.com/0/binary.js"></script>
    <script>
        var host = location.hostname;
        var img = document.querySelector('.img');
        var client = new BinaryClient('ws://' + host + ':9001');
        client.on('open', function() {
          console.log('client connected');
          client.send('foo');
        });
        client.on('stream', function(stream, meta){
          //console.log('Received stream');
          var parts = [];
          stream.on('data', function(data){
            parts.push(data);
          });
          stream.on('end', function(){
            img.src = (window.URL || window.webkitURL).createObjectURL(new Blob(parts));
            client.send('foo');
          });
        });
      </script>
</head>
<body>

<h3><%= host %></h3>
<h1><a href="http://<%= server %>:3000"><%= server %></a></h1>
<h3><%= client %></h3>
<p><%= date %></p>
<p><img id="image" src="/images/image.jpg" width="200"></p>
<p id="qr"></p>

</body>
</html>
